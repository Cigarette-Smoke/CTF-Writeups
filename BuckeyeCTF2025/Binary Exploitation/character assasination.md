Link: https://pwnoh.io/challenges
# Character Assasination
Author: jm8

Description:
```
tHe bEsT WaY To wIn aN ArGuMeNt iS To rEpEaT EvErYtHiNg tHe oThEr pErSoN SaYs lIkE ThIs

ncat --ssl character-assassination.challs.pwnoh.io 1337
```

# Source Code Analysis
- On common Linux/x86 builds ```char``` is signed (in this case -128 to 127). When you input a raw byte that exceeds the limits of the array (upper[input] >= 128), that ```char``` becomes a negative integer (e.g. 0xC0 -> -64), meaning it will start accessing memory that is allocated before ```upper[]```.
```
#include <stdio.h>

char flag[64] = "bctf{fake_flag}";
char upper[] = {
    '?',  '?',  '?', '?', '?', '?', '?', '?', '?', '\t', '\n', '\x0b', '\x0c',
    '\r', '?',  '?', '?', '?', '?', '?', '?', '?', '?',  '?',  '?',    '?',
    '?',  '?',  '?', '?', '?', '?', ' ', '!', '"', '#',  '$',  '%',    '&',
    '\'', '(',  ')', '*', '+', ',', '-', '.', '/', '0',  '1',  '2',    '3',
    '4',  '5',  '6', '7', '8', '9', ':', ';', '<', '=',  '>',  '?',    '@',
    'A',  'B',  'C', 'D', 'E', 'F', 'G', 'H', 'I', 'J',  'K',  'L',    'M',
    'N',  'O',  'P', 'Q', 'R', 'S', 'T', 'U', 'V', 'W',  'X',  'Y',    'Z',
    '[',  '\\', ']', '^', '_', '`', 'A', 'B', 'C', 'D',  'E',  'F',    'G',
    'H',  'I',  'J', 'K', 'L', 'M', 'N', 'O', 'P', 'Q',  'R',  'S',    'T',
    'U',  'V',  'W', 'X', 'Y', 'Z', '{', '|', '}', '~',
}; // 127 chars
char lower[] = {
    '?',  '?',  '?', '?', '?', '?', '?', '?', '?', '\t', '\n', '\x0b', '\x0c',
    '\r', '?',  '?', '?', '?', '?', '?', '?', '?', '?',  '?',  '?',    '?',
    '?',  '?',  '?', '?', '?', '?', ' ', '!', '"', '#',  '$',  '%',    '&',
    '\'', '(',  ')', '*', '+', ',', '-', '.', '/', '0',  '1',  '2',    '3',
    '4',  '5',  '6', '7', '8', '9', ':', ';', '<', '=',  '>',  '?',    '@',
    'a',  'b',  'c', 'd', 'e', 'f', 'g', 'h', 'i', 'j',  'k',  'l',    'm',
    'n',  'o',  'p', 'q', 'r', 's', 't', 'u', 'v', 'w',  'x',  'y',    'z',
    '[',  '\\', ']', '^', '_', '`', 'a', 'b', 'c', 'd',  'e',  'f',    'g',
    'h',  'i',  'j', 'k', 'l', 'm', 'n', 'o', 'p', 'q',  'r',  's',    't',
    'u',  'v',  'w', 'x', 'y', 'z', '{', '|', '}', '~',
}; // 127 chars

int main() {
  setvbuf(stdin, 0, 2, 0);
  setvbuf(stdout, 0, 2, 0);

  FILE *f = fopen("flag.txt", "r");
  if (f) {
    fgets(flag, sizeof(flag), f);
    fclose(f);
  }

  char input[256];

  while (1) {
    printf("> ");
    if (!fgets(input, sizeof(input), stdin)) {
      break;
    }
    for (int i = 0; i < sizeof(input) && input[i]; i++) {
      char c = input[i];
      if (i % 2) {
        printf("%c", upper[c]);
      } else {
        printf("%c", lower[c]);
      }
    }
    printf("\n");
  }
}
```
- Now, I thought if I input anything that will access upper[-64]  ```printf("%c", upper[-64]);``` will access and print the contents inside of ```flag[64]```.
```
┌──(limpbizkit㉿KaliKing)-[~] 
└─$ ncat --ssl character-assassination.challs.pwnoh.io 1337 
> À # accesses [192], which is the 64th char in flag[64] and it represents "}"
C� # output
```
- The only issue was how the terminal rendered bytes that the program sent me, it wasn't readable, so I had to write a parser
# Solution
<img width="1919" height="692" alt="image" src="https://github.com/user-attachments/assets/1240781f-aa38-43a8-a810-93750003341b" />

